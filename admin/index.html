<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ModernStore Admin Panel</title>
    <script>
      (function () {
        try {
          var originalFetch = window.fetch ? window.fetch.bind(window) : null;
          function isVitePing(u) {
            try {
              var url = new URL(typeof u === 'string' ? u : (u && u.url) || '', location.href);
              if (url.pathname === '/__vite_ping') return true;
              if (url.searchParams && url.searchParams.has('reload')) return true;
            } catch (e) {}
            return false;
          }
          if (originalFetch) {
            window.fetch = function (input, init) {
              if (isVitePing(input)) {
                try {
                  return originalFetch(input, init);
                } catch (e) {
                  return Promise.resolve(new Response('', { status: 200 }));
                }
              }
              return originalFetch(input, init);
            };
          }
        } catch (e) {}
      })();

      // Bridge: notify parent about route changes and accept parent route updates
      (function () {
        function postPath() {
          try {
            var path = (location.hash || '').replace(/^#/, '') || '/admin';
            if (window.parent) {
              window.parent.postMessage({ type: 'admin-route', path: path }, location.origin);
            }
          } catch (e) {}
        }
        window.addEventListener('hashchange', postPath);
        document.addEventListener('DOMContentLoaded', postPath);
        window.addEventListener('message', function (event) {
          if (!event || !event.data) return;
          var data = event.data || {};
          if (data.type === 'set-admin-route' && typeof data.path === 'string') {
            var desired = data.path.startsWith('#') ? data.path : '#' + data.path;
            if (location.hash !== desired) {
              location.hash = desired;
            }
          }
        });
      })();
    </script>
  </head>
  <body>
    <div id="admin-root"></div>
    <script type="module" src="/admin/main.tsx"></script>
  </body>
</html>
